https://github.com/Izrekatel/web-larek-frontend

# Проектная работа "Веб-ларек"

Проект инетрнет-магазина в котором реализован функционал:
1. Обращение с API (запрос товаров и оформление покупки, обработка ответов)
2. Заполнение страницы по данным из ответа API.

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Документация

## Алгоритм работы

При загрузке страницы исполняется js код из src/index.ts в котором:
1. Создаются классы API (api), событий (events), состояния приложения (appData) и классы отображения (страницы, общего модального окна, наполнения для различных типов окон).
2. Производится получение списка товаров через API и после получения ответа происходит наполнение страницы товарами и присвоение слушателей для всех активных элементов страницы.
3. Назначаются слушатели событий, для обработки результатов действия пользователя.
4. При осуществлении пользователем действий формируется событие, на кторое срабатывает установленный слушатель (п. 3), после чего производятся предустановленные событием действия (открытие/закрытие модальных окон, отправка запроса на API и т.д.). Все изменеиня сохраняются в состоянии приложения.

## Описание основных классов

1. Api - класс для отправки и получения ответов от стороннего сервиса API 
2. EventEmitter - брокер событий, позволяющий назначить событие и зафиксировть действие, которое нужно осуществить при событии, эмитрировать событие (для запуска предусмотренного алгоритма).
3. AppState - класс состояния приложения - в этом классе сохраняется текущее состояние (данные апи, текущие дейтсвия пользователя), формируются данные для отображения на стрнанице и для отправки в API.
4. Классы отображений: Page (странциы), Modal (общего модального окна), Basket/Order/Contacts/Success - наполнение общего модального окна в соотвествии с дуйствиями пользователя.
Классы отображений принимают данные которые необходимо отобразить на странице и возвращают их в виде HTML-разметки. 

## Группировка классов

Модель (Model):

    Api

    AppState

    Product

    PaymentInformation

    Order

    OrderResult

Представление (View):

    Page

    Modal

    Basket

    Order

    Contacts

    Success

    CatalogItem

    CatalogItemPreview

Посредник (Presenter/Controller):

    EventEmitter

    Card


## Паттерны проектирования, использованные в проекте:

1. Модуль (Module)

    Описание: Паттерн "Модуль" используется для организации кода в независимые, изолированные блоки (модули). Каждый модуль отвечает за определённую функциональность.

    Пример в проекте:

        Классы Api, EventEmitter, AppState, Page, Modal и другие организованы как отдельные модули.

        Каждый модуль инкапсулирует свою логику и предоставляет интерфейс для взаимодействия с другими частями приложения.

2. Наблюдатель (Observer)

    Описание: Паттерн "Наблюдатель" используется для реализации механизма событий. Объект (субъект) уведомляет зарегистрированных наблюдателей о произошедших изменениях.

    Пример в проекте:

        Класс EventEmitter реализует этот паттерн. Он позволяет подписываться на события (on) и эмитировать их (emit).

        Например, при изменении состояния корзины или данных формы генерируются события, которые обрабатываются соответствующими обработчиками.

3. Состояние (State)

    Описание: Паттерн "Состояние" позволяет объекту изменять своё поведение в зависимости от внутреннего состояния.

    Пример в проекте:

        Класс AppState управляет состоянием приложения (список товаров, данные пользователя, ошибки валидации и т.д.).

        В зависимости от состояния (например, валидности формы или наличия товаров в корзине), приложение меняет своё поведение (например, блокирует кнопку "Далее" или отображает ошибки).

4. Фасад (Facade)

    Описание: Паттерн "Фасад" предоставляет простой интерфейс для взаимодействия с сложной подсистемой.

    Пример в проекте:

        Класс AppState выступает в роли фасада, предоставляя удобные методы для работы с состоянием приложения (loadProducts, fillContacts, getOrderData и т.д.).

        Это упрощает взаимодействие с состоянием приложения для других компонентов.

5. Компонент (Component)

    Описание: Паттерн "Компонент" используется для создания независимых, переиспользуемых элементов интерфейса.

    Пример в проекте:

        Классы Page, Modal, Basket, Order, Contacts, Success реализуют этот паттерн. Каждый из них отвечает за отображение определённой части интерфейса.

        Компоненты инкапсулируют свою логику и могут быть переиспользованы в разных частях приложения.

6. Синглтон (Singleton)

    Описание: Паттерн "Синглтон" гарантирует, что у класса есть только один экземпляр, и предоставляет глобальную точку доступа к нему.

    Пример в проекте:

        Класс EventEmitter может быть реализован как синглтон, чтобы все компоненты приложения использовали один и тот же экземпляр для управления событиями.

        Класс AppState также может быть реализован как синглтон, чтобы состояние приложения было единым для всех компонентов.

7. Декоратор (Decorator)

    Описание: Паттерн "Декоратор" позволяет динамически добавлять объектам новую функциональность, оборачивая их в другие объекты.

    Пример в проекте:

        Классы CatalogItem и CatalogItemPreview расширяют базовый класс Card, добавляя новую функциональность (например, отображение описания товара).

8. Адаптер (Adapter)

    Описание: Паттерн "Адаптер" позволяет объектам с несовместимыми интерфейсами работать вместе.

    Пример в проекте:

        Класс Api может выступать в роли адаптера, преобразуя данные из формата API в формат, понятный приложению (например, преобразует ответ API в массив объектов IProduct).

### Описание типов данных


1. ApiListResponse

Описание: Общий тип для ответа API, содержащего список элементов.

Поля:

    total: number — общее количество элементов.

    items: Type[] — массив элементов типа Type.

2. IProduct

Описание: Описание продукта.

Поля:

    id: string — уникальный идентификатор продукта.

    description: string — описание продукта.

    image: string — URL изображения продукта.

    title: string — название продукта.

    category: string — категория продукта.

    price: number | null — цена продукта. Может быть null, если продукт бесценен.

    inBasket: boolean — флаг, указывающий, находится ли продукт в корзине.

3. IPaymentData

Описание: Данные для оплаты.

Поля:

    payment: string — способ оплаты.

    address: string — адрес доставки.

4. IContacts

Описание: Контактная информация.

Поля:

    email: string — email пользователя.

    phone: string — телефон пользователя.

5. IPaymentInformation

Описание: Расширяет IPaymentData и IContacts. Содержит полную информацию для оплаты и доставки.

Поля:

    Наследует все поля из IPaymentData и IContacts.

6. FormErrors

Описание: Тип для хранения ошибок валидации формы. Ключи — это поля из IPaymentInformation, значения — строки с описанием ошибок.

Пример:
``` typescript 
{
  payment: "Необходимо указать способ оплаты",
  address: "Необходимо указать адрес",
  email: "Неверный формат email",
  phone: "Неверный формат телефона"
} 
```
7. IOrder

Описание: Описание заказа. Расширяет IPaymentInformation.

Поля:

    Наследует все поля из IPaymentInformation.

    total: number — общая стоимость заказа.

    items: string[] — массив идентификаторов продуктов в заказе.

8. IOrderResult

Описание: Результат оформления заказа.

Поля:

    id: string — идентификатор заказа.

    total: number — общая стоимость заказа.

9. IProductAPI

Описание: Интерфейс для работы с API продуктов.

Методы:

    getProducts(): Promise<IProduct[]> — возвращает список продуктов.

    orderProducts(order: IOrder): Promise<IOrderResult> — отправляет заказ и возвращает результат.

10. IAppState

Описание: Интерфейс для управления состоянием приложения.

Поля:

    products?: IProduct[] — список продуктов. Опциональное поле.

    contacts: IPaymentInformation — контактная информация и данные для оплаты.

    validationError: FormErrors — ошибки валидации формы.

Методы:

    loadProducts(products: IProduct[]): void — загружает список продуктов.

    fillContacts(contacts: Partial<IPaymentInformation>): void — заполняет контактную информацию.

    getOrderData(): IOrder — возвращает данные для оформления заказа.

    getProductsInBasket(): IProduct[] — возвращает список продуктов в корзине.

    getBasketTotal(): number — возвращает общую стоимость продуктов в корзине.

    clearBasket(): void — очищает корзину.

    validateContacts(): void — проверяет валидность контактной информации и обновляет validationError.
    